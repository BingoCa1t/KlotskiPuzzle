# Klotski Puzzle 华容道

## Project Requirements 项目要求

### Task1 Game Initialization 游戏初始化（10分）

- [x] 游戏启动界面：实现游戏启动界面。
- [x] 板初始化：对于基本要求，板应初始化为具有不同大小块的4 x 5网格：
- [x] 块颜色区分：不同大小的块应该用不同的颜色来区分。
- [x] 重启功能：玩家可以随时重启游戏，棋盘应重置为初始状态。

### Task 2: Block Movement 积木移动（20分）

- [x] 积木移动：玩家可以控制积木的移动（上、下、左、右）。块只能沿着板上的空白区域移动，不能与其他块重叠。
- [x] 按钮控制：界面应包括上、下、左、右按钮，用于控制块移动。
- [x] 键盘控制：游戏还必须支持移动键盘控制。
- [x] 边界检测：块不能移动到板边界之外。
- [x] 碰撞检测：在移动过程中，块不能与其他块重叠。
- [x] 信息记录：在新游戏开始时，记录移动次数和其他必要信息。
- [x] 动作记录：记录每个动作并提供撤消功能（完成此功能将获得高级积分）。

### Task 3: Victory Condition 胜利条件（5分）

- [x] 胜利条件：当“曹操”挡块到达退出位置时，游戏获胜，需要显示胜利提示。
- [x] 胜利界面：胜利界面应显示玩家的移动次数。

### Task 4: Multi-User Login 多用户登录（15分）

- [x] 为访客和注册用户实现登录选择界面。
- [x] 客人可以在没有注册的情况下玩游戏，但没有保存游戏进度的功能。
- [x] 用户登录界面包括一个注册页面，允许在输入帐户凭据后登录。
- [x] 程序退出并再次运行后，以前注册的用户仍然可以登录

### Task 5: Save and Load Game 保存并加载游戏（20分）

- [x] 每个用户（访客除外）都可以加载以前保存的游戏。保存文件应为单个文件，后续保存将覆盖前一个文件（覆盖是基本操作要求。如果每个用户都有多个保存槽，则不会给出额外的分数）。
- [x] 从游戏开始界面，玩家可以选择加载上次保存的游戏。该文件应包括游戏板状态、迄今为止的移动次数和其他必要信息。
- [x] 每个用户保存的数据都是唯一的。
- [x] 手动保存是基本要求；执行定时自动保存或退出时自动保存将获得高级积分。
- [x] 保存文件错误处理：如果保存文件的格式或内容损坏，则不会加载损坏的文件，游戏应继续运行而不会崩溃。
- [x] 如果你的游戏能够检测到被他人修改的保存文件，同时仍然保持保存数据的合法性，它将获得高级积分。

### Task 6: Graphical User Interface (GUI) 图形用户界面（10分）

- [x] 使用JavaFX、Swing或任何其他Java为游戏实现图形界面图形框架。
- [x] 独立创建一个独特的GUI将获得高级积分。

### Task 7: Advanced Features 高级功能（20分）

超出基本要求的任何功能都可以获得高级积分，包括但不限于：

- [x] 界面美化：增强图形和视觉效果。
- [x] 多层次设计：设计不同难度的多个层次，每个层次有不同的布局（如果添加了多级功能，请在启动界面上提供相应的按钮以访问不同级别）。
- [x] 人工智能：实现AI算法自动解决Klotski难题。不同的智力水平将获得不同的分数。
- [x] 动画效果：为块移动添加平滑的动画。
- [x] 音效与背景音乐：通过音效和背景音乐提升游戏体验。
- [x] 时间攻击模式：引入定时模式，玩家必须在设定时间内完成游戏(如果添加了定时模式，则保存和加载操作必须包括玩家的时间使用情况,胜利界面还应显示所花费的时间)。
- [x] 道具和障碍：添加道具和障碍以丰富游戏玩法(如果添加了道具和障碍物，保存和加载操作必须包含此信息)。
- [x] 在线观看：允许多个用户同时登录并观看游戏或执行其他操作


## 项目结构

- assets: **资源管理**软件包  
    1. `AssetsPathManager`: 资源管理器，负责在程序刚开始时读取所有图片资源到内存中
    2. `ImageAssets`和`MusicAssets`: 枚举类，列举游戏中用到的所有资源
- aigo2: **自走算法**软件包，使用BFS算法
- archive: **存档管理**软件包  
    1. `ArchiveManager`: 存档管理器，负责管理活动用户(activeUser)的存档，以`MapID`为唯一标识符
    2. `LevelArchive`: 每一关卡的存档
- logic: **逻辑**软件包
    1. `ChessBoradControl`: 前后端控制器，负责控制前端的绘制和后端的逻辑
    2. `ChessBoardArray`: 后端逻辑类，负责游戏的逻辑（移动、胜利）等
    3. `LevelStatus`: 关卡状态，分为Closed、UpComing、Succeed、InProgress四种 
    4. `MoveStep`: 记录每一步的移动类，记录每次移动的Origin和Destination
    5. `Pos`: 记录坐标，有x、y、z三个字段（z暂时无用）
- map: **地图管理**软件包
    1. `MapDataManager`: 地图管理器，负责读取并管理地图数据，以`MapID`为唯一标识符
    2. `MapData`: 地图数据类
    3. `serialize`包: 序列化和反序列化器
- user: **用户**软件包
    1. `UserManager`: 用户管理类，负责注册、登录、获取存档等操作
    2. `UserInfo`: 用户信息类
- polygon: **自定义的组件，继承自Actor、Group**
    1. `Chess`: 继承自`Actor`，负责棋子的绘制
    2. `ChessBorad`: 继承自`Group`，负责管理整个棋盘的绘制
- Scene: **各个场景**
    1. `KlotskiScene`: 统一父类
    2. `ScreenManager`: 场景管理器，负责切换、回退场景等操作 
    3. `GameMainScene`: 游戏主界面
    4. `WelcomeScene`: 欢迎界面
    5. `LoginScene`: 用户登录界面
    6. `RegisterScene`: 用户注册界面
    7. `StartScene` : 用户登录之后的游戏开始界面
    8. `LevelSelectScene`: 关卡选择界面
    9. `PlayBackScene`: 回放界面
    10. `WatchScene`: 观战列表界面
    11. `SettingScene`: 设置界面

